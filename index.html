<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8" />
  <title>Fuga Neon</title>
  <style>
    body {
      margin: 0;
      background: #000;
      overflow: hidden;
    }
    canvas {
      display: block;
      margin: auto;
      background: linear-gradient(#000, #111);
    }
  </style>
</head>
<body>
<canvas id="game" width="360" height="600"></canvas>
<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let player = { x: 160, y: 520, w: 40, h: 40, speed: 5 };
let obstacles = [];
let score = 0;
let gameOver = false;
let moveDir = null;

function drawPlayer() {
  ctx.fillStyle = "#0ff";
  ctx.shadowBlur = 20;
  ctx.shadowColor = "#0ff";
  ctx.fillRect(player.x, player.y, player.w, player.h);
  ctx.shadowBlur = 0;
}

function spawnObstacle() {
  const width = 60 + Math.random() * 100;
  const x = Math.random() * (canvas.width - width);
  obstacles.push({ x, y: -40, w: width, h: 20, speed: 3 + Math.random() * 2 });
}

function drawObstacles() {
  ctx.fillStyle = "#f0f";
  ctx.shadowBlur = 10;
  ctx.shadowColor = "#f0f";
  for (let obs of obstacles) {
    ctx.fillRect(obs.x, obs.y, obs.w, obs.h);
    obs.y += obs.speed;
  }
  ctx.shadowBlur = 0;
}

function checkCollisions() {
  for (let obs of obstacles) {
    if (
      player.x < obs.x + obs.w &&
      player.x + player.w > obs.x &&
      player.y < obs.y + obs.h &&
      player.y + player.h > obs.y
    ) {
      gameOver = true;
    }
  }
}

function drawScore() {
  ctx.fillStyle = "#fff";
  ctx.font = "16px Arial";
  ctx.fillText("Pontos: " + score, 10, 20);
}

function update() {
  if (moveDir === "left") player.x -= player.speed;
  if (moveDir === "right") player.x += player.speed;

  player.x = Math.max(0, Math.min(canvas.width - player.w, player.x));

  ctx.clearRect(0, 0, canvas.width, canvas.height);
  drawPlayer();
  drawObstacles();
  checkCollisions();
  drawScore();

  if (!gameOver) {
    requestAnimationFrame(update);
    score++;
  } else {
    ctx.fillStyle = "#fff";
    ctx.font = "24px Arial";
    ctx.fillText("Game Over", 120, 300);
    ctx.fillText("Toque para recomeÃ§ar", 80, 340);
  }
}

setInterval(spawnObstacle, 1000);
update();

canvas.addEventListener("touchstart", e => {
  const touchX = e.touches[0].clientX;
  moveDir = touchX < canvas.width / 2 ? "left" : "right";

  if (gameOver) {
    // Resetar jogo
    player.x = 160;
    obstacles = [];
    score = 0;
    gameOver = false;
    update();
  }
});

canvas.addEventListener("touchend", () => {
  moveDir = null;
});
</script>
</body>
</html>